package me.mendez.ela.ml

import android.content.Context
import android.util.Log
import org.tensorflow.lite.DataType
import org.tensorflow.lite.support.tensorbuffer.TensorBuffer

private const val TAG = "ELA_CLASS_SUSPICIOUS"

class MaliciousAppClassifier(val context: Context) {
    private var model: AppsModel? = null
    private var buffer: TensorBuffer? = null
    private var permissionsMap: Map<String, Int>? = null

    enum class Result {
        MALICIOUS, BENIGN
    }

    fun load() {
        if (model == null) {
            model = AppsModel.newInstance(context)
            buffer = TensorBuffer.createFixedSize(intArrayOf(1, 596), DataType.FLOAT32)

            permissionsMap = permissionsArray()
                .mapIndexed { index, value ->
                    value to index
                }.toMap()
        }
    }

    fun destroy() {
        model?.close()
        permissionsMap = null
    }

    private fun encodePermissions(permissions: Array<String>): FloatArray {
        val array = FloatArray(permissionsMap!!.size)

        if (array.isEmpty() || permissions.isEmpty()) {
            Log.e(TAG, "returning early!")
            return array
        }

        permissions.forEach {
            val sliceStart = it.indexOf("permission")
            if (sliceStart < 0) return@forEach

            val index = permissionsMap!![it.slice(sliceStart..<it.length)]
            if (index != null) {
                array[index] = 1f
            }
        }

        return array
    }

    fun predict(packageName: String, permissions: Array<String>, minConfidence: Float = 0.5f): Result {
        val input = encodePermissions(permissions)
        buffer!!.loadArray(input)

        val confidence = model!!.process(buffer!!)
            .outputFeature0AsTensorBuffer
            .floatArray
            .first()

        val malicious = confidence > minConfidence

        Log.d(TAG, "$packageName $confidence - ${if (malicious) "MALICIOUS" else "NOT MALICIOUS"}")

        return if (confidence > minConfidence) Result.MALICIOUS else Result.BENIGN
    }


    private fun permissionsArray(): Array<String> {
        return arrayOf(
            "permission.MOUNT_UNMOUNT_FILESYSTEMS",
            "permission.CHANGE_WIFI_STATE",
            "permission.GET_TASKS",
            "permission.SYSTEM_ALERT_WINDOW",
            "permission.WRITE_SETTINGS",
            "permission.CHANGE_NETWORK_STATE",
            "permission.RECEIVE",
            "permission.C2D_MESSAGE",
            "permission.READ_LOGS",
            "permission.READ_PHONE_STATE",
            "permission.RECEIVE_USER_PRESENT",
            "permission.ACCESS_LOCATION_EXTRA_COMMANDS",
            "permission.RESTART_PACKAGES",
            "permission.INSTALL_SHORTCUT",
            "permission.SEND_SMS",
            "permission.READ_SETTINGS",
            "permission.ACCESS_WIFI_STATE",
            "permission.JPUSH_MESSAGE",
            "permission.CHANGE_CONFIGURATION",
            "permission.ACCESS_COARSE_LOCATION",
            "permission.RECORD_AUDIO",
            "permission.REQUEST_INSTALL_PACKAGES",
            "permission.CALL_PHONE",
            "permission.UNINSTALL_SHORTCUT",
            "permission.READ_EXTERNAL_STORAGE",
            "permission.DISABLE_KEYGUARD",
            "permission.READ_SMS",
            "permission.READ_GSERVICES",
            "permission.KILL_BACKGROUND_PROCESSES",
            "permission.FLASHLIGHT",
            "permission.ACCESS_FINE_LOCATION",
            "permission.CAMERA",
            "permission.DOWNLOAD_WITHOUT_NOTIFICATION",
            "permission.RECEIVE_SMS",
            "permission.BLUETOOTH",
            "permission.BROADCAST_STICKY",
            "permission.MODIFY_AUDIO_SETTINGS",
            "permission.WRITE_SMS",
            "permission.MIPUSH_RECEIVE",
            "permission.ACCESS_DOWNLOAD_MANAGER",
            "permission.BLUETOOTH_ADMIN",
            "permission.INTERACT_ACROSS_USERS_FULL",
            "permission.WRITE_APN_SETTINGS",
            "permission.BROADCAST_PACKAGE_CHANGED",
            "permission.BROADCAST_PACKAGE_INSTALL",
            "permission.BROADCAST_PACKAGE_ADDED",
            "permission.BROADCAST_PACKAGE_REPLACED",
            "permission.GET_PACKAGE_SIZE",
            "permission.ACCESS_COARSE_UPDATES",
            "permission.MANAGE_ACCOUNTS",
            "permission.REORDER_TASKS",
            "permission.MAPS_RECEIVE",
            "permission.BATTERY_STATS",
            "permission.RECEIVE_BOOT_COMPLETED",
            "permission.RUN_INSTRUMENTATION",
            "permission.INSTALL_PACKAGES",
            "permission.VIBRATE",
            "permission.SET_DEBUG_APP",
            "permission.SYSTEM_OVERLAY_WINDOW",
            "permission.ACCESS_MTK_MMHW",
            "permission.PROCESS_OUTGOING_CALLS",
            "permission.EXPAND_STATUS_BAR",
            "permission.PLUGIN",
            "permission.ACCESS_CACHE_FILESYSTEM",
            "permission.WRITE_EXTERNAL_STORAGE",
            "permission.BAIDU_LOCATION_SERVICE",
            "permission.DELETE_PACKAGES",
            "permission.ACCESS_MOCK_LOCATION",
            "permission.WRITE_SECURE_SETTINGS",
            "permission.CHANGE_WIFI_MULTICAST_STATE",
            "permission.RECEIVE_MMS",
            "permission.PACKAGE_USAGE_STATS",
            "permission.UPDATE_APP_OPS_STATS",
            "permission.SEND_DOWNLOAD_COMPLETED_INTENTS",
            "permission.CLEAR_APP_CACHE",
            "permission.CHANGE_BADGE",
            "permission.WRITE_MEDIA_STORAGE",
            "permission.GET_ACCOUNTS",
            "permission.CLEAR_APP_USER_DATA",
            "permission.UA_DATA",
            "permission.RECEIVE_ADM_MESSAGE",
            "permission.MESSAGE",
            "permission.DEVICE_POWER",
            "permission.READ_CONTACTS",
            "permission.INTERACT_ACROSS_USERS",
            "permission.WRITE_PROFILE",
            "permission.RECEIVE_WAP_PUSH",
            "permission.RECIEVE_MCS_MESSAGE",
            "permission.MODIFY_PHONE_STATE",
            "permission.READ_CALL_LOG",
            "permission.BADGE_COUNT_READ",
            "permission.BADGE_COUNT_WRITE",
            "permission.SAMSUNG_TUNTAP",
            "permission.ACCESS_GPS",
            "permission.RECORD_VIDEO",
            "permission.READ_OWNER_DATA",
            "permission.MANAGE_USERS",
            "permission.WRITE_CONTACTS",
            "permission.ACCESS_LAUNCHER_DATA",
            "permission.SET_TIME_ZONE",
            "permission.ACCES_MOCK_LOCATION",
            "permission.USE_CREDENTIALS",
            "permission.READ_INTERNAL_STORAGE",
            "permission.FORCE_STOP_PACKAGES",
            "permission.WRITE_OWNER_DATA",
            "permission.READ_USER_DICTIONARY",
            "permission.NEWS_SDK_BROADCAST",
            "permission.LOCAL_MAC_ADDRESS",
            "permission.ACCESS_WIMAX_STATE",
            "permission.CHANGE_WIMAX_STATE",
            "permission.clear_sdk",
            "permission.READ_APP_BADGE",
            "permission.READ_WRITE_SAFE_SPACE",
            "permission.READ_INSTALL_SESSIONS",
            "permission.ADD_VOICEMAIL",
            "permission.BODY_SENSORS",
            "permission.READ_CELL_BROADCASTS",
            "permission.READ_SHORTCUT",
            "permission.BROADCAST_SMS",
            "permission.GOOGLE_AUTH.cp",
            "permission.WRITE_ONLY",
            "permission.SET_WALLPAPER",
            "permission.READ_HISTORY_BOOKMARKS",
            "permission.MM_MESSAGE",
            "permission.AD_ID_NOTIFICATION",
            "permission.GOOGLE_AUTH.cl",
            "permission.READ_ONLY",
            "permission.GOOGLE_AUTH.speechpersonalization",
            "permission.GOOGLE_AUTH.jotspot",
            "permission.GOOGLE_AUTH.sitemaps",
            "permission.GOOGLE_AUTH.knol",
            "permission.GOOGLE_AUTH.speech",
            "permission.GOOGLE_AUTH.adsense",
            "permission.GOOGLE_AUTH.orkut",
            "permission.GOOGLE_AUTH.print",
            "permission.GOOGLE_AUTH.ah",
            "permission.GOOGLE_AUTH.notebook",
            "permission.GOOGLE_AUTH.groups2",
            "permission.GOOGLE_AUTH.ig",
            "permission.GOOGLE_AUTH.YouTubeUser",
            "permission.GOOGLE_AUTH.news",
            "permission.GOOGLE_AUTH.youtube",
            "permission.GOOGLE_AUTH.wifi",
            "permission.GOOGLE_AUTH.adwords",
            "permission.GOOGLE_AUTH.health",
            "permission.GOOGLE_AUTH.mobile",
            "permission.GOOGLE_AUTH.grandcentral",
            "permission.GOOGLE_AUTH.talk",
            "permission.GOOGLE_AUTH.gbase",
            "permission.GOOGLE_AUTH.dodgeball",
            "permission.NFC",
            "permission.DIAGNOSTIC",
            "permission.READ_SOCIAL_STREAM",
            "permission.BILLING",
            "permission.GOOGLE_AUTH.OTHER_SERVICES",
            "permission.GOOGLE_AUTH.local",
            "permission.GOOGLE_AUTH.lh2",
            "permission.GOOGLE_AUTH.blogger",
            "permission.WRITE_SOCIAL_STREAM",
            "permission.MOUNT_FORMAT_FILESYSTEMS",
            "permission.BIND_ACCESSIBILITY_SERVICE",
            "permission.GOOGLE_AUTH.sierraqa",
            "permission.GOOGLE_AUTH.androidsecure",
            "permission.GOOGLE_AUTH.android",
            "permission.GOOGLE_AUTH.sierrasandbox",
            "permission.GOOGLE_AUTH.sierra",
            "permission.PERSISTENT_ACTIVITY",
            "permission.ACCOUNT_MANAGER",
            "permission.TRANSMIT_IR",
            "permission.GOOGLE_AUTH.finance",
            "permission.ACCESS_NOTIFICATION_POLICY",
            "permission.MMOAUTH_CALLBACK",
            "permission.DEVICE_STATE",
            "permission.AUTH_SERVICE",
            "permission.GetuiService",
            "permission.WRITE_CALL_LOG",
            "permission.BIND_DIRECTORY_SEARCH",
            "permission.REAL_GET_TASKS",
            "permission.WRITE_RECORD_AUDIO",
            "permission.READ_MSG_PREF",
            "permission.GET_INTENT_SENDER_INTENT",
            "permission.LAUNCH_PERSONAL_PAGE_SERVICE",
            "permission.VOIP_INTERFACE",
            "permission.READ_RECORD_AUDIO",
            "permission.SOFT_RESET",
            "permission.GOOGLE_AUTH.mail",
            "permission.RECEIVE_MSG",
            "permission.USE_SIP",
            "permission.ACCESS_CHECKIN_PROPERTIES",
            "permission.ACCESS_FIND_LOCATION",
            "permission.WRITE_LOGS",
            "permission.ACCESS_WAKE_LOCK",
            "permission.UPDATE_DEVICE_STATS",
            "permission.GOOGLE_AUTH.wise",
            "permission.GOOGLE_AUTH.writely",
            "permission.ACCESS_API",
            "permission.PAYMENT",
            "permission.SHARE",
            "permission.RECEIVE_ACTIVITY_RESUMED",
            "permission.WRITE_CALENDAR",
            "permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS",
            "permission.READ_WRITE_ALL_VOICEMAIL",
            "permission.PROVIDER_INSERT_BADGE",
            "permission.ACCESS_QKPARAMS",
            "permission.GET_TOP_ACTIVITY_INFO",
            "permission.SEND",
            "permission.ACCESS_DOWNLOAD_MANAGER_ADVANCED",
            "permission.READ_PROFILE",
            "permission.SIGNAL_PERSISTENT_PROCESSES",
            "permission.GET_DETAILED_TASKS",
            "permission.ACCESS_YLPARAMS",
            "permission.READ",
            "permission.READ_UNREAD",
            "permission.ADDINSTALLKEY",
            "permission.ACCESS_WIFI_STATE.android.permission.READ_PHONE_STATE",
            "permission.WRITE_UNREAD",
            "permission.SET_ACTIVITY_WATCHER",
            "permission.RECEIVE_NOTIFICATION",
            "permission.ACCESS_SUPERUSER",
            "permission.READ_CLIPS",
            "permission.WRITE_CLIPS",
            "permission.GET_CLIPS",
            "permission.REGISTER",
            "permission.WRITE",
            "permission.CREATE_SHORTCUT",
            "permission.WRITE_APN_STORAGE",
            "permission.FLAG_GRANT_READ_URI_PERMISSION",
            "permission.BIND_JOB_SERVICE",
            "permission.SUBSCRIBED_FEEDS_READ",
            "permission.PROVIDE_BACKGROUND",
            "permission.SIM_STATE_READY",
            "permission.GALLERY_PROVIDER",
            "permission.ACCESS_SURFACE_FLINGER",
            "permission.ACCESS_CORSE_LOCATION",
            "permission.LOCATION_HARDWARE",
            "permission.FULLSCREEN.FULL",
            "permission.WRITE_INTERNAL_STORAGE",
            "permission.BIND_NOTIFICATION_LISTENER_SERVICE",
            "permission.SUBSCRIBED_FEEDS_WRITE",
            "permission.NETWORK",
            "permission.ACCESS_BACKSCREEN",
            "permission.MANAGE_LOCATION_POLICY",
            "permission.READ_APN_SETTINGS",
            "permission.ACCESSORY_FRAMEWORK",
            "permission.UPDATE_SHORTCUT",
            "permission.READ_CALENDAR",
            "permission.BIND_APPWIDGET",
            "permission.SET_ALARM",
            "permission.REGISTRATION",
            "permission.DELETE_CACHE_FILES",
            "permission.UPDATE_COUNT",
            "permission.LOCATION",
            "permission.RICHMEDIA_PROVIDER",
            "permission.account.sync",
            "permission.REBOOT_IPO",
            "permission.MONUN_UNMOUNT_FILESYSTEMS",
            "permission.FULL_SCREEN",
            "permission.READ_PHONE_SINTERNETWIFI_STATE",
            "permission.GOOGLE_AUTH",
            "permission.USE_FINGERPRINT",
            "permission.READ_MMS",
            "permission.A4S_SEND",
            "permission.NETWORK_STATE",
            "permission.LAYER_PUSH",
            "permission.WloginProvider.WRITE",
            "permission.WloginProvider.READ",
            "permission.USE_SOCIALSERVICE",
            "permission.READ_CONTENT_PROVIDER",
            "permission.sec.ENTERPRISE_DEVICE_ADMIN",
            "permission.Access",
            "permission.WRITE_HISTORY_BOOKMARKS",
            "permission.ANSWER_PHONE_CALLS",
            "permission.INSTALL_LOCATION_PROVIDER",
            "permission.activityCalled",
            "permission.REQUEST",
            "permission.ADD_SYSTEM_SERVICE",
            "permission.MOUNT_UNMOUT_FILESYSTEMS",
            "permission.MEDIA_MOUNTED",
            "permission.mkiller.ASSIST_MSAFE",
            "permission.broadcast",
            "permission.READ_WRITE_YLSECURE",
            "permission.MUSIC_CONTROL",
            "permission.SERVICE",
            "permission.CAPTURE_VIDEO_OUTPUT",
            "permission.CHANGE_COMPONENT_ENABLED_STATE",
            "permission.COLLECT_METRICS",
            "permission.AmazonAccountPropertyService.property.changed",
            "permission.METRICS_PERMISSION",
            "permission.USE_DEVICE_CREDENTIALS",
            "permission.DYN_CONFIG_VALUES_UPDATED",
            "permission.sec.MDM_SECURITY",
            "permission.APUS",
            "permission.account.changed",
            "permission.MANAGE_COR_PFM",
            "permission.avosclous.PUSH",
            "permission.CUSTOMER_ATTRIBUTE_SERVICE",
            "permission.BROADCAST_BADGE",
            "permission.OPERATE_WIDGET",
            "permission.ScanResultReceiver",
            "permission.DUMP",
            "permission.GetuiService.com.moji.mjweather",
            "permission.LAUNCH",
            "permission.MASTER_CLEAR",
            "permission.READ_LOCAL_THEME",
            "permission.READ_WRITE_QKSECURE",
            "permission.ACCESS_FINE_LACTION",
            "permission.WRITE_LOCAL_THEME",
            "permission.WRITE_APN_SETTING",
            "permission.SET_PROCESS_LIMIT",
            "permission.ACCESS_CHECKIN_PROPERTTES",
            "permission.AUTHENTICATE_ACCOUNTS",
            "permission.ACCESS_WEATHERCLOCK_PROVIDER",
            "permission.CAPTURE_AUDIO_OUTPUT",
            "permission.SET_ANIMATION_SCALE",
            "permission.MANAGE_DOCUMENTS",
            "permission.ACTIVITY_RECOGNITION",
            "permission.ANT",
            "permission.INTERNAL_BROADCAST",
            "permission.PUSHIO_MESSAGE",
            "permission.CALL_AMAZON_DEVICE_INFORMATION_PROVIDER",
            "permission.USB",
            "permission.appradio.ADVANCED_APPMODE",
            "permission.PERMISSION_NAME",
            "permission.SET_TIME",
            "permission.MODE_WORLD_READABLE",
            "permission.INTERNEL_FLAG",
            "permission.BACKUP_DATA",
            "permission.RIDE_EXTERNAL_STORAGE",
            "permission.SET_WALLPAPER_COMPONENT",
            "permission.ACCESS_SERVICE",
            "permission.SET_PROCESS_FOREGROUND",
            "permission.STATUS_BAR_SERVICE",
            "permission.SHUTDOWN",
            "permission",
            "permission.SET_WALLPAPER_HINTS",
            "permission.REBOOT",
            "permission.FOREGROUND_SERVICE",
            "permission.WRITE_USER_DICTIONARY",
            "permission..BILLING",
            "permission.READ_PRELOAD_DEVICE_INFO_PROVIDER",
            "permission.ANT_ADMIN",
            "permission.SMALLAPP",
            "permission.BIND_SERVICE",
            "permission.CALLSERVICE",
            "permission.RECEIVE_FIRST_LOAD_BROADCAST",
            "permission.READ_TASKS",
            "permission.DUID_READ_PROVIDER",
            "permission.WIFI_STATE",
            "permission.HW_SIGNATURE_OR_SYSTEM",
            "permission.CAN_CALL_MAP_INFORMATION_PROVIDER",
            "permission.NOTIFICATION",
            "permission.GENERIC_IPC",
            "permission.sec.MDM_CERTIFICATE",
            "permission.mewidget_contact",
            "permission.UPDATE_BADGE",
            "permission.INCOMING_CALL",
            "permission.FORE_SERVICE",
            "permission.READ_EPG_DATA",
            "permission.ACCOUNT_NOTICE",
            "permission.downloadservice",
            "permission.pushnotify",
            "permission.WRITE_EPG_DATA",
            "permission.NETWORK_PROVIDER",
            "permission.cleandroid_cn",
            "permission.GetuiService.com.xjbd",
            "permission.CHANGE_NETWORK_SATET",
            "permission.OPPO_COMPONENT_SAFE",
            "permission.MOUNT_UNMOUNT_FILESYSTEM",
            "permission.WRITE_EXTERNAL_STORAG",
            "permission.BACK_ENGINE",
            "permission.ACCESS_NETWORK_STAT",
            "permission.RKILL_BACKGROUND_PROCESSES",
            "permission.RETRIEVE_WINDOW_CONTENT",
            "permission.INSTALL_DRM",
            "permission.INJECT_EVENTS",
            "permission.READ_SOCIAL_DATABASE",
            "permission.WRITE_SOCIAL_DATABASE",
            "permission.NNI_MESSAGE",
            "permission.WRITE_BADGES",
            "permission.CAPTURE_SECURE_VIDEO_OUTPUT",
            "permission.BACKUP",
            "permission.prod.SYSTEM_COMMUNICATION",
            "permission.READ_SECURE_SETTINGS",
            "permission.GOOGLE_PHOTOS",
            "permission.BLUETOOTH_PRIVILEGED",
            "permission.NFC_TRANSACTION",
            "permission.READ_CALL_SETTINGS",
            "permission.READ_CREDENTIALS",
            "permission.SMARTCARD",
            "permission.WRITE_TASKS",
            "permission.LINKED_ARTICLE",
            "permission.NATIVEDIALER",
            "permission.KEYSTRING",
            "permission.WRITE_ATTACHMENT",
            "permission.CONTENT_PROVIDER",
            "permission.WRITE_CALL_SETTINGS",
            "permission.WRITE_GMAIL",
            "permission.REMOTE_CONTROL",
            "permission.TRANSACTION_EVENT",
            "permission.AM_COMMUNICATION",
            "permission.APP_PLATFORM",
            "permission.ACCOUNTS",
            "permission.sec.MDM_PHONE_RESTRICTION",
            "permission.ACCESS_APPLICATION_DATA",
            "permission.DATABASE",
            "permission.WRITE_TING_MP3",
            "permission.access_wifi_state",
            "permission.write_apn_settings",
            "permission.ACCESS_FINAL_LOCATION",
            "permission.watermark",
            "permission.HCE_PUSH_MESSAGE",
            "permission.OVERRIDE_WIFI_CONFIG",
            "permission.ACCESS_KUGOU_SERVICE",
            "permission.READER_PUSH",
            "permission.REMOVE_TASKS",
            "permission.DISABLE_STATUS_BAR",
            "permission.BADGE_WRITE",
            "permission.READ_INPUT_STATE",
            "permission.MDM_SERVICE",
            "permission.OPEN_JUMP_INTENTS",
            "permission.GetuiService.com.gameabc.zhanqiAndroid",
            "permission.START_BACKGROUND_SERVICE",
            "permission.BADGE_READ",
            "permission.mount_unmount_filesystems",
            "permission.SINA_PUSH",
            "permission.AIRPLANE_MODE",
            "permission.READ_WEATHER",
            "permission.READ_TING_MP3",
            "permission.AIDL_SERVICE",
            "permission.MEDIA_REMOVED_ACTION",
            "permission.RECEIVE_USER_PERSENT",
            "permission.READ_FRAME_BUFFER",
            "permission.CONTROL_LOCATION_UPDATES",
            "permission.STATUS_BAR",
            "permission.HARDWARE_TEST",
            "permission.ACCESS_ASSISTED_GPS",
            "permission.USE_SOCIALCOMPONENT",
            "permission.READ_PRIVILEGED_PHONE_STATE",
            "permission.ACCESS_DRM",
            "permission.READ_PHONE_NUMBERS",
            "permission.SEND_VIEW",
            "permission.READ_GMAIL",
            "permission.STORAGE",
            "permission.LISTEN_QUIZ_PROGRESS",
            "permission.DEVICE_EXTRAS",
            "permission.GOOGLE_AUTH.goanna_mobile",
            "permission.network",
            "permission.sec.MDM_REMOTE_CONTROL",
            "permission.APPLICATION_INTERFACE",
            "permission.SEND_MAIL",
            "permission.sec.MDM_BROWSER_SETTINGS",
            "permission.AVIATE_INTER_APP",
            "permission.READ_BOOKMARKS_URI",
            "permission.READ_ATTACHMENT_PREVIEW",
            "permission.sec.MDM_FIREWALL",
            "permission.FILESYSTEM_INTERFACE",
            "permission.pcsync",
            "permission.READ_PHONE_STATUS",
            "permission.AMC_MAIN",
            "permission.GetuiService.mobi.charmer.fotocollage",
            "permission.sec.MDM_APP_MGMT",
            "permission.sec.MDM_HW_CONTROL",
            "permission.sec.MDM_EXCHANGE",
            "permission.UEMOJI",
            "permission.NFC_SE",
            "permission.GAMIFICATION",
            "permission.SHARE_DATA",
            "permission.READ_WRITE_BOOKMARK_FOLDERS",
            "permission.BEACON_RESULT_RECEIVE",
            "permission.GetuiService.com.dealmoon.android",
            "permission.com.airmailes.read",
            "permission.AMAZON_ACCOUNT_PROPERTY",
            "permission.UNINSTALL_PACKAGES",
            "permission.ACTION_BOOT_COMPLETED",
            "permission.SIGNATURE_OR_SYSTEM",
            "permission.SCROBBLET_PRIVATE_SERVICE",
            "permission.MY_READ_MESSAGES",
            "permission.HANDLE_DEVICE_MESSAGE",
            "permission.sec.MDM_ROAMING",
            "permission.sec.MDM_KIOSK_MODE",
            "permission.ReadSharedData2",
            "permission.c2dm.permission.RECEIVE",
            "permission.GetuiService.com.asiainno.uplive",
            "permission.ACCESS_PHONE_STATE",
            "permission.RECEIVE_BADGE",
            "permission.air.escapegamestudio.AntarcticDolphinEscape.permission.C2D_MESSAGE",
            "permission.ACCESS_ACCOUNT_UTIL",
            "permission.AVIATE_RECEIVE",
            "permission.EMAIL_BROADCAST",
            "permission.sec.MDM_LOCATION",
            "permission.OPEN_APP",
            "permission.com.airmailes.write",
            "permission.sec.MDM_WIFI",
            "permission.DATA_SYNCHRONIZATION",
            "permission.sec.MDM_RESTRICTION",
            "permission.INTERNAL_COMMON",
            "permission.REMOTE_LOCK_SERVICE",
            "permission.INTERPROCESS_INTERFACE",
            "permission.READ_PRELOAD_APP_INFO_PROVIDER",
            "permission.sec.MDM_VPN",
            "permission.appradio.AAM2",
            "permission.REGISTER_ACCOUNT",
            "permission.PROVIDER",
            "permission.SECURITY_INTERFACE",
            "permission.profiler.TRIGGER_SENSOR_BROADCAST_RECEIVE",
            "permission.DEVICE_INTERFACE",
            "permission.CONTACT",
            "permission.VOIP_BROADCAST_VOIP_INTENTS",
            "permission.RECEIVE_FOURSQUARE_BROADCAST",
            "permission.INVOKE_WIPE_FEATURES",
            "permission.PICASA_STORE",
            "permission.INTERNAL_COMPONENT",
            "permission.VOIP_SHOW_INCOMING_CALL",
            "permission.profiler.SENSOR_BROADCAST_RECEIVE",
            "permission.READ_NOTIFICATIONS",
            "permission.ACCOUNT",
            "permission.sec.MDM_ENTERPRISE_VPN",
            "permission.CEMOJI",
            "permission.MY_DELETE_MESSAGES",
            "permission.sec.MDM_INVENTORY",
            "permission.TRIGGER_UPLOAD",
            "permission.PER_ACCOUNT_TYPE",
            "permission.MY_READ_ATTACHMENT",
            "permission.sec.MDM_BLUETOOTH",
            "permission.GUIDE_DOWNLOAD_INFORMATION",
            "permission.INVOKE_INTERNAL_HANDLER",
            "permission.SECURED_BROADCAST",
            "permission.CHECK_JOAOMGCD_LICENSE",
            "permission.MY_REMOTE_CONTROL",
            "permission.PRIVATE_PERMISSION",
            "permission.SOUND",
            "permission.READER_EXTERNAL_STORAGE",
            "permission.READ_SETTINGS_PERMISSION",
            "permission.USE_SDK.com.tencent.tmgp.sgame.KingsGlory",
            "permission.RECEIVE_SENDTO",
            "permission.GetuiService.com.myxianwen.nanguozaobao",
            "permission.READ_USAGESTATS",
            "permission.GET_PERMISSIONS",
            "permission.GetuiService.InternetRadio.all",
            "permission.USEFMRADIO",
            "permission.access_network_state",
            "permission.GetuiService.com.babychat.teacher",
            "permission.GetuiService.com.rtk.app",
            "permission.SEND_NETEASE_POMELO_PUSH_SERVICE_NEWS",
            "permission.GetuiService.com.cmcc.mobilevideo",
            "permission.WRITE_USAGESTATS",
            "permission.GetuiService.com.hwl.universitystrategy",
            "permission.READ_ACCOUNTINFO",
            "permission.GetuiService.com.m4399.gamecenter",
            "permission.WRITE_PUSHINFOPROVIDER.com.fy.tnzbsq",
            "permission.PUSHSERVICE",
            "permission.GetuiService.com.lietou.mishu",
            "permission.PROCESS_PUSH_MSG",
            "permission.account",
            "permission.clear_sdk_lds",
            "permission.GRANT_RUNTIME_PERMISSIONS",
            "permission.ACCESS_KUWO_SERVICE",
            "permission.DOWNLOAD_WITHOUT_NOTIFICATION.",
            "permission.GetuiService.com.jifen.qukan",
            "permission.MOUNT_UNMOUNT_FILESYSTE",
            "permission.CREATE_USERS",
            "permission.NOTIFY_SERVICE",
            "permission.READ0_PHONE_STATE",
            "permission.CHANGE_NEWWORK_STATE",
            "permission.READ_PROVIDER",
            "permission.GetuiService.com.zhangkongapp.joke.bamenshenqi",
            "permission.GetuiService.com.greate.myapplication",
            "permission.DOWNLOAD_CACHE_NON_PURGEABLE",
            "permission.FORCE_BACK",
            "permission.FLAG_ACTIVITY_NEW_TASK",
            "permission.GetuiService.com.vlocker.locker",
            "permission.downloadservice_nfc",
            "permission.GetuiService.com.netease.newsreader.activity",
            "permission.GetuiService.com.storm.smart",
            "permission.PHONE_STATE",
            "permission.KSYUN_ACCESS",
            "permission.WRITE_PUSHINFOPROVIDER.com.myxianwen.nanguozaobao",
            "permission.READ_SECRET_CONTACTS",
            "permission.CORE_SERVICE",
            "permission.WEIBO_SDK_PERMISSION",
            "permission.WRITE_PUSHINFOPROVIDER.com.tv.kuaisou",
            "permission.RECIVER",
            "permission.GetuiService.com.sina.weibolite",
            "permission.android.hardware.sensor.accelerometer",
            "permission.GetuiService.com.itangyuan",
            "permission.SEND_NETEASE_POMELO_PUSH_MESSAGE_SERVICE",
            "permission.AUTH_THIRDPAY",
            "permission.BIND_VPN_SERVICE",
            "permission.WRITE_PUSHINFOPROVIDER.com.nd.android.pandahome2",
            "permission.ACCESS_LOCATION",
            "permission.RECEIVE_LAUNCH_BROADCASTS",
            "permission.CONNECTIVITY_INTERNAL",
            "permission.PROCESS_INCOMING_CALLS",
            "permission.SYSTEM_UI_VISIBILITY_EXTENSION",
            "permission.CAMERA_ADDON",
            "permission.STOP_APP_SWITCHES"
        )
    }
}
